# Process Injection // Syscalls

## Useful Links

[IDA Debugger](https://www.hex-rays.com/ida-free/)
[SYSCALL TABLE (up to Win10 build 20H2)](https://j00ru.vexillium.org/syscalls/nt/64/)
[SysWhispers](https://github.com/jthuraisamy/SysWhispers)

## Mini-projects

- syscalls.c

#### [syscalls.c](./syscalls.c)

Implementing process injection with XORed shellcode & syscalls (lower-level = better).

## Notes

Using a debugger like IDA, we can search for known functions and see what their syscall numbers are. Standard syscall procedure says that the value being moved to the **eax** reg.

![IDA debug showing us the syscall of CreateThreadEx](../../assets/IDA_CreateThreadEx_debugger.PNG)

_However_, depending on the version of Windows we have, the syscall number for our desired function could be completely different.
So. How can we dynamically get the syscall numbers needed for our exploits?
[This!](https://github.com/jthuraisamy/SysWhispers) 

`python syswhispers.py -f NtOpenProcess,NtAllocateVirtualMemory,NtWriteVirtualMemory,NtCreateThreadEx,NtClose -v 10 -o syscalls`

It's important to note that this doesn't always have the most up-to-date Windows builds, and therefore we should just add (copy from latest vers) our vers to the syscalls.asm following the standard format, `<FUNCTION>_Check_10_0_XXXX`.


