# Process Injection // NTDLL

## Useful Links

[NTAPI Undocumented Funcs](http://undocumented.ntinternals.net/)
[Vergilius Project](https://www.vergiliusproject.com/kernels/x64/Windows%2010%20%7C%202016/2110%2021H2%20(November%202021%20Update))

## Mini-projects

- complete_ntdll.c

#### [complete_ntdll.c](./complete_ntdll.c)

This is the same as dllinjection.c, however we implement every single NTAPI version of any WinAPI calls we use. Lower level = better.

WinAPI:
> OpenProcess() ---> VirtualAllocEx() ---> WriteProcessMemory() ---> CreateRemoteThreadEx()
NTAPI:
> NtOpenProcess() or NtCreateProcess() ---> NtAllocateVirtualMemory() ---> NtWriteVirtualMemory() ---> NtCreateThreadEx()

## Notes

Using a debugger like WinDbg, we can dump structure names like:
> dt nt!_UNICODE_STRING

![WinDbg on UNICODE_STRING](../../../assets/WinDbg_unicode_str.png)

