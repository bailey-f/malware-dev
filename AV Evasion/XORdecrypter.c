#include <stdio.h>
#include <string.h>

/* place encoded shellcode here */
unsigned char shellcode[] = "\x9e\x7c\xb2\x88\xc3\x91\xa2\x34\x31\x6c\x72\x28\x23\x64\x63\x3d\x65"
                                "\x31\x53\xe6\x54\x24\xb8\x2b\x02\x7c\xba\x3e\x2b\x31\xe9\x66\x11"
                                "\x24\xb8\x0b\x32\x7c\x3e\xdb\x79\x33\x2f\x05\xf8\x24\x02\xb9\xce"
                                "\x08\x50\x10\x31\x55\x42\x75\xf0\xa5\x3e\x38\x63\xf5\xd3\x81\x61"
                                "\x38\x33\x7c\xba\x3e\x13\xf2\x20\x08\x79\x6d\xe3\xf2\xe2\xbc\x31"
                                "\x6c\x33\x31\xe7\xf4\x45\x0b\x7b\x78\xb2\x64\xba\x24\x2b\x3d\xe9"
                                "\x74\x11\x25\x32\xa9\x81\x62\x79\x93\xfa\x38\xe9\x00\xb9\x24\x32"
                                "\xaf\x2f\x05\xf8\x24\x02\xb9\xce\x75\xf0\xa5\x3e\x38\x63\xf5\x09"
                                "\x8c\x46\x88\x2e\x37\x7d\x48\x3b\x3c\x5b\xe5\x44\xb4\x6b\x3d\xe9"
                                "\x74\x15\x25\x32\xa9\x04\x75\xba\x60\x7b\x3d\xe9\x74\x2d\x25\x32"
                                "\xa9\x23\xbf\x35\xe4\x7b\x78\xb2\x75\x69\x2d\x6b\x27\x3b\x6e\x70"
                                "\x34\x72\x20\x23\x6e\x79\xef\xdf\x59\x23\x66\xce\x8c\x6b\x38\x3b"
                                "\x6e\x79\xe7\x21\x90\x35\xcb\xce\x93\x6e\x31\xd8\x35\x31\x6c\x33"
                                "\x79\x62\x34\x31\x24\xbe\xf4\x63\x35\x31\x6c\x72\xc3\x53\xbf\x5e"
                                "\xeb\xcc\xac\xd9\xd4\x2c\x46\x39\x38\xd8\x92\xa4\xd1\xae\x86\xb7"
                                "\x7c\xb2\xa8\x1b\x45\x64\x48\x3b\xec\xc8\x99\x17\x31\x8a\x2b\x20"
                               "\x0b\x0d\x5e\x31\x35\x72\xf0\xb8\xcb\xe4\x0f\x5e\x1d\x4c\x51\x49"
                                "\x09\x13\x56\x01\x14\x52\x0d\x5f\x1a\x4c\x51\x49\x09\x33\x79"; // calc spawn

int main(int argc, char* argv[]) {

	if (argc < 2) {
		printf("(-) usage: xordecrypter.exe <key>\n");
		return 1;
	}

	char* key = argv[1]; /* make sure this is the same key used in the encryption process */

	printf("(*) decoding with key: %s\n", key);
	printf("(+) decoded %zd-bytes\n\n\r", sizeof(shellcode));
	printf("unsigned char shellcode[] = \"");
	size_t keyLength = strlen(key);
	for (int x = 0; x < sizeof(shellcode) - 1; x++) {
		shellcode[x] = shellcode[x] ^ key[x % keyLength];
		printf("\\x%02x", shellcode[x]);
	}
	printf("\";");
	
	return 0;

}